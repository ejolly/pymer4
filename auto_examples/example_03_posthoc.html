<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. ANOVA tables and post-hoc comparisons &#8212; pymer4 0.8.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=0bf093e7" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=f9948e0f"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Simulating Data" href="example_04_simulating_data.html" />
    <link rel="prev" title="2. Categorical Predictors" href="example_02_categorical.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Pymer4</a>
        <span class="navbar-text navbar-version pull-left"><b>0.8.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="index.html">Tutorial</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="https://github.com/ejolly/pymer4">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Nav <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../new.html">What's New</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rfx_cheatsheet.html">Lme4 RFX Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">TOC <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">3. ANOVA tables and post-hoc comparisons</a><ul>
<li><a class="reference internal" href="#anova-tables-and-orthogonal-contrasts">ANOVA tables and orthogonal contrasts</a></li>
<li><a class="reference internal" href="#marginal-estimates-and-post-hoc-comparisons">Marginal estimates and post-hoc comparisons</a><ul>
<li><a class="reference internal" href="#example-1">Example 1</a></li>
<li><a class="reference internal" href="#example-2">Example 2</a></li>
<li><a class="reference internal" href="#example-3">Example 3</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-example-03-posthoc-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="anova-tables-and-post-hoc-comparisons">
<span id="sphx-glr-auto-examples-example-03-posthoc-py"></span><h1>3. ANOVA tables and post-hoc comparisons<a class="headerlink" href="#anova-tables-and-post-hoc-comparisons" title="Permalink to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ANOVAs and post-hoc tests are only available for <code class="code docutils literal notranslate"><span class="pre">Lmer</span></code> models estimated using the <code class="code docutils literal notranslate"><span class="pre">factors</span></code> argument of <code class="code docutils literal notranslate"><span class="pre">model.fit()</span></code> and rely on implementations in R</p>
</div>
<p>In the previous tutorial where we looked at categorical predictors, behind the scenes <code class="code docutils literal notranslate"><span class="pre">pymer4</span></code> was using the <code class="code docutils literal notranslate"><span class="pre">factor</span></code> functionality in R. This means the output of <code class="code docutils literal notranslate"><span class="pre">model.fit()</span></code> looks a lot like <code class="code docutils literal notranslate"><span class="pre">summary()</span></code> in R applied to a model with categorical predictors. But what if we want to compute an F-test across <em>all levels</em> of our categorical predictor?</p>
<p><code class="code docutils literal notranslate"><span class="pre">pymer4</span></code> makes this easy to do, and makes it easy to ensure Type III sums of squares infereces are valid. It also makes it easy to follow up omnibus tests with post-hoc pairwise comparisons.</p>
<section id="anova-tables-and-orthogonal-contrasts">
<h2>ANOVA tables and orthogonal contrasts<a class="headerlink" href="#anova-tables-and-orthogonal-contrasts" title="Permalink to this heading">¶</a></h2>
<p>Because ANOVA is just regression, <code class="code docutils literal notranslate"><span class="pre">pymer4</span></code> can estimate ANOVA tables with F-results using the <code class="code docutils literal notranslate"><span class="pre">.anova()</span></code> method on a fitted model. This will compute a Type-III SS table given the coding scheme provided when the model was initially fit. Based on the distribution of data across factor levels and the specific coding-scheme used, this may produce invalid Type-III SS computations. For this reason the <code class="code docutils literal notranslate"><span class="pre">.anova()</span></code> method has a <code class="code docutils literal notranslate"><span class="pre">force-orthogonal=True</span></code> argument that will reparameterize and refit the model using orthogonal polynomial contrasts prior to computing an ANOVA table.</p>
<p>Here we first estimate a mode with dummy-coded categories and suppress the summary output of <code class="code docutils literal notranslate"><span class="pre">.fit()</span></code>. Then we use <code class="code docutils literal notranslate"><span class="pre">.anova()</span></code> to examine the F-test results.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import basic libraries and sample data</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pymer4.utils</span> <span class="kn">import</span> <span class="n">get_resource_path</span>
<span class="kn">from</span> <span class="nn">pymer4.models</span> <span class="kn">import</span> <span class="n">Lmer</span>

<span class="c1"># IV3 is a categorical predictors with 3 levels in the sample data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_resource_path</span><span class="p">(),</span> <span class="s2">&quot;sample_data.csv&quot;</span><span class="p">))</span>

<span class="c1"># # We&#39;re going to fit a multi-level regression using the</span>
<span class="c1"># categorical predictor (IV3) which has 3 levels</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Lmer</span><span class="p">(</span><span class="s2">&quot;DV ~ IV3 + (1|Group)&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Using dummy-coding; suppress summary output</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">factors</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;IV3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="s2">&quot;1.5&quot;</span><span class="p">]},</span> <span class="n">summarize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Get ANOVA table</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">anova</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>SS Type III Analysis of Variance Table with Satterthwaite approximated degrees of freedom:
(NOTE: Using original model contrasts, orthogonality not guaranteed)
              SS           MS  NumDF     DenomDF    F-stat     P-val Sig
IV3  2359.778135  1179.889067      2  515.000001  5.296284  0.005287  **
</pre></div>
</div>
<p>Type III SS inferences will only be valid if data are fully balanced across levels or if contrasts between levels are orthogonally coded and sum to 0. Below we tell <code class="code docutils literal notranslate"><span class="pre">pymer4</span></code> to respecify our contrasts to ensure this before estimating the ANOVA. <code class="code docutils literal notranslate"><span class="pre">pymer4</span></code> also saves the last set of contrasts used priory to forcing orthogonality.</p>
<p>Because the sample data is balanced across factor levels and there are not interaction terms, in this case orthogonal contrast coding doesn’t change the results.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get ANOVA table, but this time force orthogonality</span>
<span class="c1"># for valid SS III inferences</span>
<span class="c1"># In this case the data are balanced so nothing changes</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">anova</span><span class="p">(</span><span class="n">force_orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>SS Type III Analysis of Variance Table with Satterthwaite approximated degrees of freedom:
(NOTE: Model refit with orthogonal polynomial contrasts)
              SS           MS  NumDF     DenomDF    F-stat     P-val Sig
IV3  2359.778135  1179.889067      2  515.000001  5.296284  0.005287  **
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checkout current contrast scheme (for first contrast)</span>
<span class="c1"># Notice how it&#39;s simply a linear contrast across levels</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">factors</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;IV3&#39;: [&#39;0.5&#39;, &#39;1.0&#39;, &#39;1.5&#39;]}
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Checkout previous contrast scheme</span>
<span class="c1"># which was a treatment contrast with 1.0</span>
<span class="c1"># as the reference level</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">factors_prev_</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;IV3&#39;: [&#39;1.0&#39;, &#39;0.5&#39;, &#39;1.5&#39;]}
</pre></div>
</div>
</section>
<section id="marginal-estimates-and-post-hoc-comparisons">
<h2>Marginal estimates and post-hoc comparisons<a class="headerlink" href="#marginal-estimates-and-post-hoc-comparisons" title="Permalink to this heading">¶</a></h2>
<p><code class="code docutils literal notranslate"><span class="pre">pymer4</span></code> leverages the <code class="code docutils literal notranslate"><span class="pre">emmeans</span></code> package in order to compute marginal estimates (“cell means” in ANOVA lingo) and pair-wise comparisons of models that contain categorical terms and/or interactions. This can be performed by using the <code class="code docutils literal notranslate"><span class="pre">.post_hoc()</span></code> method on fitted models. Let’s see an example:</p>
<p>First we’ll quickly create a second categorical IV to demo with and estimate a 3x3 ANOVA to get main effects and the interaction.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the random number generator</span>
<span class="c1"># for reproducibility</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Create a new categorical variable with 3 levels</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">IV4</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># Estimate model with orthogonal polynomial contrasts</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Lmer</span><span class="p">(</span><span class="s2">&quot;DV ~ IV4*IV3 + (1|Group)&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">factors</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;IV4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">],</span> <span class="s2">&quot;IV3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="s2">&quot;1.5&quot;</span><span class="p">]},</span>
    <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">summarize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Get ANOVA table</span>
<span class="c1"># We can ignore the note in the output because</span>
<span class="c1"># we manually specified polynomial contrasts</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">anova</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>SS Type III Analysis of Variance Table with Satterthwaite approximated degrees of freedom:
(NOTE: Using original model contrasts, orthogonality not guaranteed)
                  SS           MS  NumDF     DenomDF    F-stat     P-val Sig
IV4       449.771051   224.885525      2  510.897775  1.006943  0.366058
IV3      2486.124318  1243.062159      2  508.993080  5.565910  0.004063  **
IV4:IV3   553.852530   138.463132      4  511.073624  0.619980  0.648444
</pre></div>
</div>
<section id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this heading">¶</a></h3>
<p>Compare each level of IV3 to each other level of IV3, <em>within</em> each level of IV4. Use default Tukey HSD p-values.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute post-hoc tests</span>
<span class="n">marginal_estimates</span><span class="p">,</span> <span class="n">comparisons</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">post_hoc</span><span class="p">(</span>
    <span class="n">marginal_vars</span><span class="o">=</span><span class="s2">&quot;IV3&quot;</span><span class="p">,</span> <span class="n">grouping_vars</span><span class="o">=</span><span class="s2">&quot;IV4&quot;</span>
<span class="p">)</span>

<span class="c1"># &quot;Cell&quot; means of the ANOVA</span>
<span class="nb">print</span><span class="p">(</span><span class="n">marginal_estimates</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>P-values adjusted by tukey method for family of 3 estimates
   IV3 IV4  Estimate  2.5_ci  97.5_ci     SE      DF
1  1.0   1    42.554  33.778   51.330  4.398  68.140
2  0.5   1    45.455  36.644   54.266  4.417  69.299
3  1.5   1    40.904  32.196   49.612  4.361  65.943
4  1.0   2    42.092  33.301   50.882  4.406  68.609
5  0.5   2    41.495  32.829   50.161  4.339  64.626
6  1.5   2    38.786  29.961   47.612  4.425  69.746
7  1.0   3    43.424  34.741   52.107  4.348  65.149
8  0.5   3    46.008  37.261   54.755  4.383  67.208
9  1.5   3    38.119  29.384   46.854  4.376  66.801
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pairwise comparisons</span>
<span class="nb">print</span><span class="p">(</span><span class="n">comparisons</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>          Contrast IV4  Estimate  2.5_ci  ...       DF  T-stat  P-val  Sig
1  IV31.0 - IV30.5   1    -2.901  -9.523  ...  510.016  -1.030  0.558
2  IV31.0 - IV31.5   1     1.650  -4.750  ...  510.137   0.606  0.817
3  IV30.5 - IV31.5   1     4.552  -1.951  ...  510.267   1.645  0.228
4  IV31.0 - IV30.5   2     0.596  -5.749  ...  510.249   0.221  0.973
5  IV31.0 - IV31.5   2     3.305  -3.387  ...  510.883   1.161  0.477
6  IV30.5 - IV31.5   2     2.709  -3.749  ...  510.732   0.986  0.586
7  IV31.0 - IV30.5   3    -2.584  -8.893  ...  510.213  -0.963  0.601
8  IV31.0 - IV31.5   3     5.305  -1.006  ...  510.710   1.976  0.119
9  IV30.5 - IV31.5   3     7.889   1.437  ...  510.663   2.874  0.012    *

[9 rows x 10 columns]
</pre></div>
</div>
</section>
<section id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this heading">¶</a></h3>
<p>Compare each unique IV3,IV4 “cell mean” to every other IV3,IV4 “cell mean” and used FDR correction for multiple comparisons:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute post-hoc tests</span>
<span class="n">marginal_estimates</span><span class="p">,</span> <span class="n">comparisons</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">post_hoc</span><span class="p">(</span>
    <span class="n">marginal_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;IV3&quot;</span><span class="p">,</span> <span class="s2">&quot;IV4&quot;</span><span class="p">],</span> <span class="n">p_adjust</span><span class="o">=</span><span class="s2">&quot;fdr&quot;</span>
<span class="p">)</span>

<span class="c1"># Pairwise comparisons</span>
<span class="nb">print</span><span class="p">(</span><span class="n">comparisons</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>P-values adjusted by fdr method for 36 comparisons
                     Contrast  Estimate  2.5_ci  ...  T-stat  P-val  Sig
1   IV31.0 IV41 - IV30.5 IV41    -2.901 -11.957  ...  -1.030  0.535
2   IV31.0 IV41 - IV31.5 IV41     1.650  -7.102  ...   0.606  0.726
3   IV31.0 IV41 - IV31.0 IV42     0.463  -8.657  ...   0.163  0.871
4   IV31.0 IV41 - IV30.5 IV42     1.059  -7.649  ...   0.391  0.835
5   IV31.0 IV41 - IV31.5 IV42     3.768  -5.364  ...   1.326  0.473
6   IV31.0 IV41 - IV31.0 IV43    -0.870  -9.659  ...  -0.318  0.869
7   IV31.0 IV41 - IV30.5 IV43    -3.454 -12.306  ...  -1.254  0.473
8   IV31.0 IV41 - IV31.5 IV43     4.435  -4.426  ...   1.609  0.390
9   IV30.5 IV41 - IV31.5 IV41     4.552  -4.341  ...   1.645  0.390
10  IV30.5 IV41 - IV31.0 IV42     3.364  -5.732  ...   1.189  0.493
11  IV30.5 IV41 - IV30.5 IV42     3.960  -4.883  ...   1.440  0.446
12  IV30.5 IV41 - IV31.5 IV42     6.669  -2.568  ...   2.321  0.186
13  IV30.5 IV41 - IV31.0 IV43     2.031  -6.796  ...   0.740  0.637
14  IV30.5 IV41 - IV30.5 IV43    -0.552  -9.603  ...  -0.196  0.869
15  IV30.5 IV41 - IV31.5 IV43     7.336  -1.568  ...   2.648  0.118
16  IV31.5 IV41 - IV31.0 IV42    -1.188 -10.044  ...  -0.431  0.827
17  IV31.5 IV41 - IV30.5 IV42    -0.591  -9.041  ...  -0.225  0.869
18  IV31.5 IV41 - IV31.5 IV42     2.117  -6.937  ...   0.752  0.637
19  IV31.5 IV41 - IV31.0 IV43    -2.520 -11.037  ...  -0.951  0.535
20  IV31.5 IV41 - IV30.5 IV43    -5.104 -13.818  ...  -1.883  0.362
21  IV31.5 IV41 - IV31.5 IV43     2.785  -5.986  ...   1.021  0.535
22  IV31.0 IV42 - IV30.5 IV42     0.596  -8.082  ...   0.221  0.869
23  IV31.0 IV42 - IV31.5 IV42     3.305  -5.848  ...   1.161  0.493
24  IV31.0 IV42 - IV31.0 IV43    -1.333 -10.235  ...  -0.481  0.811
25  IV31.0 IV42 - IV30.5 IV43    -3.916 -12.888  ...  -1.403  0.446
26  IV31.0 IV42 - IV31.5 IV43     3.972  -4.883  ...   1.442  0.446
27  IV30.5 IV42 - IV31.5 IV42     2.709  -6.123  ...   0.986  0.535
28  IV30.5 IV42 - IV31.0 IV43    -1.929 -10.318  ...  -0.739  0.637
29  IV30.5 IV42 - IV30.5 IV43    -4.513 -13.207  ...  -1.669  0.390
30  IV30.5 IV42 - IV31.5 IV43     3.376  -5.172  ...   1.270  0.473
31  IV31.5 IV42 - IV31.0 IV43    -4.638 -13.457  ...  -1.691  0.390
32  IV31.5 IV42 - IV30.5 IV43    -7.222 -16.183  ...  -2.590  0.118
33  IV31.5 IV42 - IV31.5 IV43     0.667  -8.475  ...   0.235  0.869
34  IV31.0 IV43 - IV30.5 IV43    -2.584 -11.212  ...  -0.963  0.535
35  IV31.0 IV43 - IV31.5 IV43     5.305  -3.325  ...   1.976  0.351
36  IV30.5 IV43 - IV31.5 IV43     7.889  -0.935  ...   2.874  0.118

[36 rows x 9 columns]
</pre></div>
</div>
</section>
<section id="example-3">
<h3>Example 3<a class="headerlink" href="#example-3" title="Permalink to this heading">¶</a></h3>
<p>For this example we’ll estimate a more complicated ANOVA with 1 continuous IV and 2 categorical IVs with 3 levels each. This is the same model as before but with IV2 thrown into the mix. Now, pairwise comparisons reflect changes in the <em>slope</em> of the continuous IV (IV2) between levels of the categorical IVs (IV3 and IV4).</p>
<p>First let’s get the ANOVA table</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Lmer</span><span class="p">(</span><span class="s2">&quot;DV ~ IV2*IV3*IV4 + (1|Group)&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="c1"># Only need to polynomial contrasts for IV3 and IV4</span>
<span class="c1"># because IV2 is continuous</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">factors</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;IV4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">],</span> <span class="s2">&quot;IV3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="s2">&quot;1.5&quot;</span><span class="p">]},</span>
    <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">summarize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Get ANOVA table</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">anova</span><span class="p">())</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>SS Type III Analysis of Variance Table with Satterthwaite approximated degrees of freedom:
(NOTE: Using original model contrasts, orthogonality not guaranteed)
                       SS            MS  NumDF  ...      F-stat         P-val  Sig
IV2          46010.245470  46010.245470      1  ...  306.765451  1.220547e-54  ***
IV3            726.318000    363.159000      2  ...    2.421301  8.984551e-02    .
IV4            143.379932     71.689966      2  ...    0.477981  6.203159e-01
IV2:IV3        613.455876    306.727938      2  ...    2.045056  1.304528e-01
IV2:IV4          4.914900      2.457450      2  ...    0.016385  9.837494e-01
IV3:IV4         92.225327     23.056332      4  ...    0.153724  9.612985e-01
IV2:IV3:IV4    368.085569     92.021392      4  ...    0.613537  6.530638e-01

[7 rows x 7 columns]
</pre></div>
</div>
<p>Now we can compute the pairwise difference in slopes</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute post-hoc tests with bonferroni correction</span>
<span class="n">marginal_estimates</span><span class="p">,</span> <span class="n">comparisons</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">post_hoc</span><span class="p">(</span>
    <span class="n">marginal_vars</span><span class="o">=</span><span class="s2">&quot;IV2&quot;</span><span class="p">,</span> <span class="n">grouping_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;IV3&quot;</span><span class="p">,</span> <span class="s2">&quot;IV4&quot;</span><span class="p">],</span> <span class="n">p_adjust</span><span class="o">=</span><span class="s2">&quot;bonf&quot;</span>
<span class="p">)</span>

<span class="c1"># Pairwise comparisons</span>
<span class="nb">print</span><span class="p">(</span><span class="n">comparisons</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>P-values adjusted by bonf method for 3 comparisons
          Contrast IV4  Estimate  2.5_ci  ...       DF  T-stat  P-val  Sig
1  IV31.0 - IV30.5   1    -0.053  -0.254  ...  502.345  -0.638  1.000
2  IV31.0 - IV31.5   1    -0.131  -0.313  ...  502.494  -1.734  0.250
3  IV30.5 - IV31.5   1    -0.078  -0.278  ...  502.821  -0.933  1.000
4  IV31.0 - IV30.5   2    -0.038  -0.210  ...  501.096  -0.526  1.000
5  IV31.0 - IV31.5   2     0.002  -0.184  ...  502.745   0.031  1.000
6  IV30.5 - IV31.5   2     0.040  -0.142  ...  502.836   0.530  1.000
7  IV31.0 - IV30.5   3    -0.134  -0.329  ...  502.956  -1.646  0.301
8  IV31.0 - IV31.5   3    -0.110  -0.302  ...  502.109  -1.368  0.516
9  IV30.5 - IV31.5   3     0.024  -0.166  ...  502.538   0.304  1.000

[9 rows x 10 columns]
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-example-03-posthoc-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/e7ef29a00a8623944961d93353aaeb69/example_03_posthoc.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">example_03_posthoc.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/70d6b9ce5a4ead51666a28dfea75fae5/example_03_posthoc.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">example_03_posthoc.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017-2024, Eshin Jolly.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>